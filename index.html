<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Simulador de Fixture - Copa LPF</title>
  <style>
    body {
      font-family: sans-serif;
      background: #000;
      margin: 0;
      padding: 2rem;
      color: white;
    }
    .fixture {
      display: flex;
      flex-direction: row;
      justify-content: space-around;
      align-items: center;
      gap: 1rem;
    }
    .column {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      align-items: center;
    }
    h1 {
      text-align: center;
      margin-bottom: 2rem;
      font-size: 2rem;
    }
    .match {
      background: #222;
      border-radius: 4px;
      padding: 0.3rem;
      text-align: center;
      width: 60px;
    }
    .match .date {
      font-size: 0.6rem;
      color: #ccc;
      margin: 0.2rem 0;
    }
    .teams {
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }
    .team {
      display: flex;
      align-items: center;
      justify-content: center;
      background: #333;
      border-radius: 3px;
      padding: 0.2rem;
      cursor: pointer;
    }
    .team img {
      width: 20px;
      height: 20px;
    }
    .team.selected {
      outline: 2px solid #fff;
      outline-offset: 1px;
    }
    .trophy-column {
      width: 80px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .trophy-column img {
      width: 40px;
      height: auto;
    }
    .champion {
      margin-top: 1rem;
      font-size: 0.8rem;
      text-align: center;
    }
    #shareBtn {
      display: block;
      margin: 2rem auto;
      padding: 0.5rem 1rem;
      font-size: 1rem;
      background: #00bb66;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #branding {
      text-align: center;
      margin-top: 2rem;
    }
    #branding img {
      width: 120px;
    }
  </style>
</head>
<body>
  <h1>Simulador de Fixture - Copa LPF</h1>
  <div id="capture" class="fixture">
    <div class="column" id="col-left"></div>
    <div class="column" id="col-quarters-left"></div>
    <div class="column" id="col-semifinal-left"></div>
    <div class="trophy-column">
      <img src="https://cdn-icons-png.flaticon.com/512/862/862875.png" alt="Trofeo">
      <div id="final" class="column"></div>
      <div id="champion" class="champion"></div>
    </div>
    <div class="column" id="col-semifinal-right"></div>
    <div class="column" id="col-quarters-right"></div>
    <div class="column" id="col-right"></div>
  </div>

  <div id="branding">
    <img src="https://www.bolavip.com/__export/1668693772936/sites/bolavip/img/2022/11/17/logo_bolavip.png" alt="Bolavip">
  </div>

  <button id="shareBtn">Compartir por WhatsApp</button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
  const duelosIzq = [
    ['aaaj', 'instituto'],
    ['sanlorenzo', 'tigre'],
    ['river', 'barracas'],
    ['racing', 'platense']
  ];
  const duelosDer = [
    ['rosariocentral', 'estudiantes'],
    ['huracan', 'riestra'],
    ['boca', 'lanus'],
    ['independiente', 'independientemza']
  ];
  const fechas = [
    '11/05 - 18:00', '10/05 - 14:00', '12/05 - 20:30', '10/05 - 18:45',
    '10/05 - 16:30', '11/05 - 20:30', '10/05 - 21:00', '11/05 - 15:30'
  ];

  const colLeft = document.getElementById('col-left');
  const colRight = document.getElementById('col-right');
  const colQFLeft = document.getElementById('col-quarters-left');
  const colQFRight = document.getElementById('col-quarters-right');
  const colSemiL = document.getElementById('col-semifinal-left');
  const colSemiR = document.getElementById('col-semifinal-right');
  const finalContainer = document.getElementById('final');
  const championDisplay = document.getElementById('champion');

  function crearMatch(equipo1, equipo2, fecha, avanzar) {
    const match = document.createElement('div');
    match.className = 'match';
    const teams = document.createElement('div');
    teams.className = 'teams';
    const team1 = document.createElement('div');
    team1.className = 'team';
    team1.innerHTML = `<img src='https://via.placeholder.com/40x40?text=${equipo1}'>`;
    const team2 = document.createElement('div');
    team2.className = 'team';
    team2.innerHTML = `<img src='https://via.placeholder.com/40x40?text=${equipo2}'>`;
    const date = document.createElement('div');
    date.className = 'date';
    date.textContent = fecha;
    team1.addEventListener('click', () => seleccionarGanador(team1, team2, equipo1, avanzar));
    team2.addEventListener('click', () => seleccionarGanador(team2, team1, equipo2, avanzar));
    teams.appendChild(team1);
    if (fecha) teams.appendChild(date);
    teams.appendChild(team2);
    match.appendChild(teams);
    return match;
  }

  function seleccionarGanador(g, otro, equipoGanador, avanzar) {
    g.classList.add('selected');
    otro.classList.remove('selected');
    if (avanzar && typeof avanzar === 'function') avanzar(equipoGanador);
  }

  function avanzarRonda(equipos, container, siguienteAvance) {
    container.innerHTML = '';
    for (let i = 0; i < equipos.length; i += 2) {
      const match = crearMatch(equipos[i], equipos[i + 1], '', siguienteAvance(i >> 1));
      container.appendChild(match);
    }
  }

  const ganadoresOctavosIzq = [], ganadoresOctavosDer = [];
  const ganadoresQFIzq = [], ganadoresQFDer = [];
  let finalistas = [];

  duelosIzq.forEach((duelo, i) => {
    const match = crearMatch(duelo[0], duelo[1], fechas[i], (ganador) => {
      ganadoresOctavosIzq[i] = ganador;
      if (ganadoresOctavosIzq.filter(Boolean).length === 4) {
        avanzarRonda(ganadoresOctavosIzq, colQFLeft, (j) => (g) => {
          ganadoresQFIzq[j] = g;
          if (ganadoresQFIzq.filter(Boolean).length === 2) {
            avanzarRonda(ganadoresQFIzq, colSemiL, (k) => (sf) => {
              finalistas[k] = sf;
              if (finalistas.filter(Boolean).length === 2) mostrarFinal();
            });
          }
        });
      }
    });
    colLeft.appendChild(match);
  });

  duelosDer.forEach((duelo, i) => {
    const match = crearMatch(duelo[0], duelo[1], fechas[i + 4], (ganador) => {
      ganadoresOctavosDer[i] = ganador;
      if (ganadoresOctavosDer.filter(Boolean).length === 4) {
        avanzarRonda(ganadoresOctavosDer, colQFRight, (j) => (g) => {
          ganadoresQFDer[j] = g;
          if (ganadoresQFDer.filter(Boolean).length === 2) {
            avanzarRonda(ganadoresQFDer, colSemiR, (k) => (sf) => {
              finalistas[1 + k] = sf;
              if (finalistas.filter(Boolean).length === 2) mostrarFinal();
            });
          }
        });
      }
    });
    colRight.appendChild(match);
  });

  function mostrarFinal() {
    finalContainer.innerHTML = '';
    championDisplay.innerHTML = '';
    const match = crearMatch(finalistas[0], finalistas[1], '', (campeon) => {
      championDisplay.innerHTML = `<strong>¡Campeón!</strong><br><img src='https://via.placeholder.com/40x40?text=${campeon}'>`;
    });
    finalContainer.appendChild(match);
  }

  const shareBtn = document.getElementById('shareBtn');
shareBtn.addEventListener('click', async () => {
  const captureEl = document.getElementById('capture');
  const canvas = await html2canvas(captureEl, { useCORS: true });
  canvas.toBlob(async blob => {
    const formData = new FormData();
    formData.append('image', blob);
    formData.append('key', 'YOUR_IMGBB_API_KEY'); // Reemplazá con tu API key de imgbb

    try {
      const res = await fetch('https://api.imgbb.com/1/upload', {
        method: 'POST',
        body: formData
      });
      const json = await res.json();
      const imageUrl = json.data.url;
      window.open(`https://wa.me/?text=¡Mirá mi pronóstico de la Copa LPF! %0A${imageUrl}`, '_blank');
    } catch (err) {
      console.error('Error al subir la imagen', err);
      alert('No se pudo compartir la imagen.');
    }
  });
});
</script>
</body>
</html>
